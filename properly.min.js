// Properly v0.2.0
Properly=function(){var Properly=function(prop){if(this instanceof Properly){this.name=prop;this.get=Properly.getter(prop);this.set=Properly.setter(prop);this.rem=Properly.remover(prop)}else{var p=Properly.getter(prop);p.name=prop;p.set=Properly.setter(prop);p.rem=Properly.remover(prop);return p}};Properly.version="0.2.0";Properly.getter=function(prop){var fields=Properly.parseFieldNames(prop),len=fields.length;if(len>1){return function(d){for(var i=0;i<len;i++){var field=fields[i];d=d[field]}return d}}else{return function(d){return d[prop]}}};Properly.get=function(obj,prop){return Properly.getter(prop).call(null,obj)};Properly.multigetter=function(propOrProps){var fields=propOrProps instanceof Array?propOrProps:_slice(arguments);var getters=fields.map(Properly.getter);return function(d){return getters.map(function(get){return get(d)})}};Properly.multiget=function(obj,propOrProps){return Properly.multigetter.apply(null,_slice(arguments,1)).call(null,obj)};Properly.setter=function(prop){var fields=Properly.parseFieldTypes(prop),len=fields.length;if(len>1){return function(d,value){for(var i=0;i<len;i++){var field=fields[i];if(field.type){d=d[field.name]||(d[field.name]=new field.type)}else if(d instanceof Array&&field.name===""){d.push(value)}else{d[field.name]=value}}return d}}else{return function(d,value){return d[prop]=value}}};Properly.set=function(obj,prop,value){return Properly.setter(prop).call(null,obj,value)};Properly.multisetter=function(keyValues){var items=[];for(var key in keyValues){items.push({set:Properly.setter(key),value:keyValues[key]})}return function(d){return items.map(function(item){return item.set(d,item.value)})}};Properly.multiset=function(obj,keyValues){return Properly.multisetter(keyValues).call(null,obj)};Properly.remover=function(prop){var fields=Properly.parseFieldNames(prop),len=fields.length;if(len>1){return function(d,value){for(var i=0;i<len;i++){var field=fields[i];if(i===len-1){delete d[field]}else{d=d[field];if(typeof d==="undefined")break}}}}else{return function(d){delete d[prop]}}};Properly.remove=function(obj,prop){return Properly.remover(prop).call(null,obj)};Properly.multiremover=function(propOrProps){var fields=propOrProps instanceof Array?propOrProps:_slice(arguments);var len=fields.length;return function(d){for(var i=0;i<len;i++){Properly.remove(obj,fields[i])}}};Properly.multiremove=function(obj,props){return Properly.multiremover(props).call(null,obj)};Properly.wrap=function(obj){return{get:function(prop){return Properly.get(obj,prop)},set:function(prop,value){return Properly.set(obj,prop,value)},rem:function(prop){return Properly.remove(obj,prop)}}};Properly.wrap.prop=function(obj,prop){var p=Properly(prop);return{get:function(){return p.get(obj)},set:function(value){return p.set(obj,value)},rem:function(){return p.rem(obj)}}};Properly.template=function(tmpl){return function(d){return tmpl.replace(/{([^}]+)}/g,function(match,prop){return Properly.get(d,prop)})}};Properly.parseFieldNames=function(prop){return Properly.parseFieldTypes(prop).map(function(type){return type.name})};Properly.parseFieldTypes=function(prop){var fields=[],field={name:""};function pushField(){if(fields.length&&fields[fields.length-1].type===Array){var index=parseInt(field.name);if(!isNaN(index)){field.name=index}}fields.push(field);field={name:""}}while(prop.length){var chr=prop.charAt(0);prop=prop.substr(1);if(chr==="."){field.type=Object}else if(chr==="["){field.type=Array}else if(chr==="]"){if(prop.length){var next=prop.charAt(0);switch(next){case".":field.type=Object;break;case"[":field.type=Array;break;default:throw"Expected '.' or '[' after ']'; got '"+next+"'"}}chr="";prop=prop.substr(1)}if(field.type){pushField()}else{field.name+=chr}}pushField();return fields};function _slice(a,b,c){return Array.prototype.slice.call(a,b,c)}function _map(a,b){return Array.prototype.map.call(a,b)}return Properly}();if(typeof module==="object")module.exports=Properly;